CONTAINER_NAME=zookeeper1
CONTAINER_NETWORK_NAME=kafka-network
CONTAINER_HOST_NAME=zookeeper1


PROJECT_PATH=$(dirname $(dirname $PWD))
ZK_CONFIG_EXTERNAL_PATH="${PROJECT_PATH}/build/configs/zoo.cfg"
ZK_CONFIG_INTERNAL_PATH="/opt/bitnami/zookeeper/conf/zoo.cfg"

ZK_DYNAMIC_CONFIG_EXTERNAL_PATH="${PROJECT_PATH}/build/configs/dynamic-config.cfg"
ZK_DYNAMIC_CONFIG_INTERNAL_PATH="/bitnami/zookeeper/dynamic-config.cfg"

ZK_DATA_EXTERNAL_PATH="${PROJECT_PATH}/volume/data"
ZK_DATA_INTERNAL_PATH="/bitnami/zookeeper/data"

ZK_LOG_EXTERNAL_PATH="${PROJECT_PATH}/volume/logs"
ZK_LOG_INTERNAL_PATH="/bitnami/zookeeper/logs"

ZK_HEALTHCHECK_EXTERNAL_PATH="$(pwd)/zk-health-check.sh"
ZK_HEALTHCHECK_INTERNAL_PATH="/opt/healthchecks/zk-health-check.sh"

CLIENT_HOST_PORT=2181
CLIENT_CONTAINER_PORT=2181

ADMIN_SERVER_HOST_PORT=8080
ADMIN_SERVER_CONTAINER_PORT=8080

ZK_FOLLOWER_SERVER_HOST_PORT=2888
ZK_FOLLOWER_SERVER_CONTAINER_PORT=2888

ZK_LEADER_SERVER_HOST_PORT=3888
ZK_LEADER_SERVER_CONTAINER_PORT=3888

# zookeeper baglanti kontrolu icin
ZK_CHECK_LOCALHOST="localhost"
ZK_GROUP_URL="/commands"
ZK_ENDPOINT_URL="/ruok"
ZK_HEALTH_EXPECTED_ERROR="\"error\" : null"

# HEALTH_CMD="bash $(pwd)/zk-health-check.sh"
# HEALTH_CMD="curl -s ${CONTAINER_HOST_NAME}:${ADMIN_SERVER_CONTAINER_PORT}${ZK_GROUP_URL}${ZK_ENDPOINT_URL}"

# Kafka broker'ları (hostname, port) formatında
# HEALTH_CHECK_BROKERS="kafka-broker1:9092 kafka-broker2:9093 kafka-broker3:9094"
HEALTH_CHECK_BROKERS="kafka-broker1:9092"

HEALTH_ERROR_MSG="Zookeeper1 health check failed"
HEALTH_SUCCESS_MSG="Zookeeper1 health check passed"
HEALTH_INTERVAL=10s
HEALTH_TIMEOUT=5s
HEALTH_RETRIES=3

MAX_RETRIES=7
RETRY_DELAY=3

RESTART_POLICY="on-failure"
RESTART_MAX_RETRIES=3



# Zookeeper Sunucu Kimliği
ZOO_MY_ID=1

# ZOO_SERVERS="server.1=zookeeper1:2888:3888;2181 server.2=zookeeper2:2888:3888;2182 server.3=zookeeper3:2888:3888;2183"

# Zookeeper dinleyicileri (tüm IP adreslerinden bağlantıya izin ver)
ZOO_LISTENERS="CLIENT://0.0.0.0:2181"
# IP bazlı tanımlama
# ZOO_LISTENERS="CLIENT://192.168.1.100:2181,CLIENT://192.168.1.200:2181"
# container hostname bazlı tanımlama
# ZOO_LISTENERS="CLIENT://zookeeper2:2181,CLIENT://kafka-zookeeper3:2181"


# Kimlik doğrulama ayarları
ZOO_ENABLE_AUTH=no
ALLOW_ANONYMOUS_LOGIN=yes

# Admin sunucusu ayarları
ZOO_ADMINSERVER_ENABLED=true
ZOO_ADMINSERVER_PORT=8080

# Zookeeper zamanlama ayarları
ZOO_TICK_TIME=2000
ZOO_INIT_LIMIT=10
ZOO_SYNC_LIMIT=5

# Otomatik temizleme ayarları
ZOO_AUTOPURGE_SNAPRETAINCOUNT=3
ZOO_AUTOPURGE_PURGEINTERVAL=1

# Maksimum istemci bağlantısı sayısı
# debian limiti genellikle default olarak 1024, bu limit, sistem yöneticisi tarafından artırılabilir.
# DoS, DDOS ve kaynakların yeterliliğine göre sunucu çökmesini engelleme için ek güvenlik sağlar.
ZOO_MAX_CLIENT_CNXNS=60

CONTAINER_IMAGE=bitnami/zookeeper:latest


